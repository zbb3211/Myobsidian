# 7.1 管道
## 7.1.1 概念
1. 管道类似于文件重定向，可以将前一个命令的标准输出`stdout`重定向到下一个命令的标准输入`stdin`。

## 7.1.2 要点
1. 管道命令仅处理`stdout`，会忽略标准错误`stderr`。
2. 管道右边的命令必须能接受`stdin`。
3. 多个管道命令可以串联。

## 7.1.3 与文件重定向的区别
- 文件重定向左边为命令，右边为文件。
- 管道左右两边均为命令，左边有`stdout`，右边有`stdin`。
## 7.1.4 例子
- 找到当前文件夹中所有`.py`文件：find . -name '\*.py'
- 将上处内容输入到`cat`：find . -name '\*.py' | xargs cat
	- >cat可以接受stdin。xargs将stdin的内容用空行隔开作为cat的命令行参数，传给cat。
	- 上述命令会列举出`.py`文件的所有内容。
- 统计当前目录下`.py`文件的总行数：find . -name '\*.py' | xargs cat | wc -l
	- > wc：统计，wc -l：统计标注输入里内容的总行数

# 7.2 环境变量
## 7.2.1 概念
1. Linux系统中会用很多环境变量来记录配置信息。
2. 环境变量类似于全局变量，可以被各个进程访问到。可以通过修改环境变量来方便地修改系统配置。
## 7.2.2 查看
1. 列出当前环境下的所有环境变量：
```md
env # 显示当前用户的变量
set # 显示当前shell的变量，包括当前用户的变量
export # 显示当前导出成用户变量的shell变量
```
2. 输出某个环境变量的值：
```md
echo $PATH
```

## 7.2.3 修改
环境变量的定义、修改、删除操作可以参考3. shell语法——变量这一节的内容。

为了将对环境变量的修改应用到未来所有环境下，可以将修改命令放到`~./bashrc`文件中。
修改完`~./bashrc`文件后，记得执行`source ~./bashrc`，来将修改应用到当前的`bash`环境下。

为何将修改命令放到`~.bashrc`，就可以确保修改会影响未来所有的环境呢？
- 每次启动`bash`，都会先执行`~./bashrc`。
- 每次`ssh`登录远程服务器，都会启动一个`bash`命令行给我们。
- 每次`tmux`新开一个`pane`，都会启动一个`bash`命令行给我们。

所以未来所有新开的环境都会加载我们修改的内容。

## 7.2.4 常见环境变量
1. `HOME`：用户的家目录。
2. `PATH`：可执行文件（命令）的存储路径。路径与路径之间用:分隔。当某个可执行文件同时出现在多个路径中时，会选择从左到右数第一个路径中的执行。下列所有存储路径的环境变量，均采用从左到右的优先顺序。
3. `LD_LIBRARY_PATH`：用于指定动态链接库(.so文件)的路径，其内容是以冒号分隔的路径列表。
4. `C_INCLUDE_PATH`：C语言的头文件路径，内容是以冒号分隔的路径列表。
5. `CPLUS_INCLUDE_PATH`：CPP的头文件路径，内容是以冒号分隔的路径列表。
6. `PYTHONPATH`：Python导入包的路径，内容是以冒号分隔的路径列表。
7. `JAVA_HOME`：jdk的安装目录。
8. `CLASSPATH`：存放Java导入类的路径，内容是以冒号分隔的路径列表。

## 7.2.5 注意点
1. 将`~homework/lesson_6/thrift_lesson/match_system/src`中的`./main`改成`match-server`。
复制当前路径`/home/acs/homework/lesson_6/thrift_lesson/match_system/src`，打开`~./bashrc`，在末尾加上
```md
export PATH=/home/acs/homework/lesson_6/thrift_lesson/match_system/src:$PATH
```
执行`source ~./bashrc`，PATH中会增加一条路径。同时，`match-server`会变成一条命令。

将自己写了命令行的目录存放到PATH内，就可以像使用命令行一样，使用自己写的程序。
# 7.3 常用命令
## 7.3.1 系统状况
1. `top`：查看所有进程的信息（Linux的任务管理器）
	- 打开后，输入M：按使用内存排序
	- 打开后，输入P：按使用CPU排序
	- 打开后，输入q：退出
2. `df -h`：查看硬盘使用情况
3. `free -h`：查看内存使用情况
4. `du -sh`：查看当前目录占用的硬盘空间
5. `ps aux`：查看所有进程
	- `ps aux | grep xxx`，查找进程xxx
6. `kill -9 pid`：杀死编号为pid的进程
	- 传递某个具体的信号：kill -s SIGTERM pid
7. `netstat -nt`：查看所有网络连接
8. `w`：列出当前登陆的用户
9. `ping www.baidu.com`：检查是否连网
## 7.3.2 文件权限
1. `chmod`：修改文件权限
	- `chmod +x xxx`：给xxx添加可执行权限
	- `chmod -x xxx`：去掉xxx的可执行权限
	- `chmod 777 xxx`：将xxx的权限改成777，用二进制给每个位置设置权限。
	- `chmod 777 xxx -R`：递归修改整个文件夹的权限
权限格式：d|rwx|rwx|rwx，分别问文件类型，自己的权限，同组人的权限，其他人的权限。
## 7.3.3 文件检索
1. `find /path/to/directory/ -name '*.py'`：搜索某个文件路径下的所有*.py文件
2. `grep xxx`：从stdin中读入若干行数据，如果某行中包含xxx，则输出该行；否则忽略该行。
	- `find homework/lesson_6/ -name '*.cpp' | xargs cat | grep 'acs_4835'`，查找该文件夹下所有`.cpp`文件中包含`acs_4835`的代码行
3. `wc`：统计行数、单词数、字节数
	- 既可以从stdin中直接读入内容；也可以在命令行参数中传入文件名列表；
	- wc -l：统计行数
	- wc -w：统计单词数
	- wc -c：统计字节数
4. `tree`：展示当前目录的文件结构
	- tree /path/to/directory/：展示某个目录的文件结构
	- tree -a：展示隐藏文件
5. `ag xxx`：搜索当前目录下的所有文件，检索xxx字符串
6. `cut`：分割一行内容
	- 从stdin中读入多行数据
	- `echo $PATH | cut -d ':' -f 3,5`：输出PATH用:分割后第3、5列数据
	- `echo $PATH | cut -d ':' -f 3-5`：输出PATH用:分割后第3-5列数据
	- `echo $PATH | cut -c 3,5`：输出PATH的第3、5个字符
	- `echo $PATH | cut -c 3-5`：输出PATH的第3-5个字符
7. `sort`：将每行内容按字典序排序
	- 可以从stdin中读取多行数据
	- 可以从命令行参数中读取文件名列表
8. `xargs`：将stdin中的数据用空格或回车分割成命令行参数
	- `find . -name '*.py' | xargs cat | wc -l`：统计当前目录下所有python文件的总行数

## 7.3.4 查看文件内容
1. `more`：浏览文件内容
	- 回车：下一行
	- 空格：下一页
	- `b`：上一页
	- `q`：退出
2. `less`：与more类似，功能更全
	- 回车：下一行
	- `y`：上一行
	- Page Down：下一页
	- Page Up：上一页
	- `q`：退出
3. `head -3 xxx`：展示xxx的前3行内容
	- 同时支持从stdin读入内容
4. `tail -3 xxx`：展示xxx末尾3行内容
	- 同时支持从stdin读入内容
## 7.3.5 用户相关
1. `history`：展示当前用户的历史操作。内容存放在`~/.bash_history`中
## 7.3.6 工具
1. `md5sum`：计算md5哈希值
	- 可以从stdin读入内容
	- 也可以在命令行参数中传入文件名列表；
2. `time command`：统计command命令的执行时间
3. `ipython3`：交互式python3环境。可以当做计算器，或者批量管理文件。
	- ! echo "Hello World"：!表示执行shell脚本
4. `watch -n 0.1 command`：每0.1秒执行一次command命令
5. `tar`：压缩文件
	- `tar -zcvf xxx.tar.gz /path/to/file/\*`：压缩
	- `tar -zxvf xxx.tar.gz`：解压缩
6. `diff xxx yyy`：查找文件xxx与yyy的不同点
## 7.3.7 安装软件
1. `sudo command`：以root身份执行command命令
2. `apt-get install xxx`：安装软件
3. `pip install xxx --user --upgrade`：安装python包
